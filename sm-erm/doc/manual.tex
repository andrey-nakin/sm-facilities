\documentclass[12pt, a4paper, twocolumn]{report}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{hyperref}
\usepackage[]{graphicx}

%\makeindex

\newcommand{\PROGNAME}{app-sm-erm}

\input{../../commons/doc/style.tex}
\input{../../commons/doc/commands.tex}

\title{Установка по измерению электросопротивления в~зависимости от~температуры с~ручным управлением температурой образца. \\ Руководство пользователя}
\author{Накин~А.~В.}
\input{title.tex}

\begin{document}

\maketitle

\tableofcontents

\chapter{Общие сведения}

Установка представляет собой программно-аппаратный комплекс для регистрации удельного сопротивления материалов (далее~--- Образцов) в зависимости от температуры.

Установка производит съём показаний измерительных приборов, вычисление значения сопротивления со всеми сопутствующими погрешностями и запись результатов в файлы данных.

Установка сама никак не влияет на температуру Образца, а только регистрирует её вместе с сопротивлением.

Одновременно Установка способна работать только с одним единственным Образцом.

\section{Состав Установки}

\subsection{Состав аппаратной части}

Аппаратная часть Установки состоит из персональной ЭВМ (далее~--- ПЭВМ) и следующих приборов:

\begin{itemize}

\item Мультиметры В7-78 (далее~--- мультиметр) (2~шт.). Предназначены для измерения сопротивления Образца. Мультиметры управляются ПЭВМ посредством USB интерфейса.

\item Произвольный источник питания (далее~--- ИП) постоянного тока (1~шт.). Предназначен для запитывания электрической цепи с Образцом.

\item Измеритель-регулятор одноканальный ТРМ-201 компании ОВЕН (1~шт.). Предназначен для определения температуры Образца посредством термопары. Управляется ПЭВМ посредством прибора АС-4, к которому подключён посредством интерфейса RS-485.

\item Блок из 8-ми управляемых реле МВУ-110 компании ОВЕН (1~шт.). Предназначен для коммутации приборов и Образца. Управляется ПЭВМ посредством прибора АС-4, к которому подключён посредством интерфейса RS-485.

\item Преобразователь интерфейсов USB/RS-485 АС-4 компании ОВЕН (1~шт.). Предназначен для подключения МВУ-110 и ТРМ-201 к ПЭВМ через USB интерфейс.

\end{itemize}

\section{Принцип работы}

Установка периодически с заданной частотой измеряет сопротивление и температуру Образца и записывает результаты в файлы, а также выводит на экран ПЭВМ для оперативного контроля. Оператор вручную управляет температурой Образца.

\label{sec_registration_types}

Частота регистрации (записи в файл) измерений вводится оператором перед началом измерений и может задаваться одним из следующих способов:

\begin{itemize}
\item {\bf Временная зависимость}~--- показания регистрируются с фиксированным временным интервалом, например один раз в секунду.
\item {\bf Температурная зависимость}~--- показания регистрируются с фиксированным температурным шагом, например $1$~Кельвин.
\item \label{sec_reg_type_manual} {\bf Вручную}~--- показания регистрируются по команде оператора.
\end{itemize}

\subsection{Определение температуры}

\input{t-measures.tex}

\subsection{Определение сопротивления}

\input{r-measures.tex}

\subsection{Удельное сопротивление}

\input{../../commons/doc/rho-calcs.tex}

\section{Принципиальная схема}
\label{sec_schematic_diagram}

Принципиальная схема Установки приведена на рис.~\ref{pic-scheme}.

Образец R1 подключён к разъёму J3: токовые контакты к выходам 1 и 5, потенциальные --- к выходам 6 и 9.

Источник питания постоянного тока I1 подключается к контактам 7, 8 разъёма J1.

Мультиметр MM1 может работать:

\begin{enumerate}
\item как вольтметр, измеряя напряжение на потенциальных контактах Образца;
\item либо как омметр, измеряя полное сопротивление Образца; в этом случае мультиметр MM2 не используется, а к контактам 5, 6 разъёма J1 подключены входы <<$\Omega$~4~пр>> мультиметра MM1.
\end{enumerate}

Мультиметр MM2 может работать как амперметр, измеряя ток в цепи Образца, либо отсутствовать.

Полярность подключения мультиметров и ИП не важна.

Термопара подключена к контактам 3, 4 разъёма J1. Полярность подключения играет роль.

Сдвоенный переключатель S1 предназначен для изменения полярности подключения ИП в цепь Образца.

Переключатель S2 предназначен для размыкания цепи Образца. Размыкание производится:

\begin{itemize}
\item либо в момент переключения полярности посредством S1 во избежание короткого замыкания ИП;
\item либо при измерении сопротивления при помощи омметра, поскольку в данном случае запитка Образца не требуется.
\end{itemize}

\begin{figure*}
\begin{center}
\includegraphics[width=1.0\textwidth, clip, viewport=100 115 650 510]{scheme}
\end{center}
\caption{Принципиальная схема Установки}
\label{pic-scheme}
\end{figure*}

\chapter{Подготовка к работе}

\section{Подготовка аппаратной части}

Включение приборов рекомендуется производить в указанной последовательности.

\subsection{Коммутация мультиметров и ИП}

\input{dmm-leads.tex}

\subsection{Подготовка Образца и термопары}

Подключите измерительную сборку с установленным Образцом к разъёму J3. Термопару --- к контактам 3 и 4 разъёма J1.

\subsection{Подготовка ТРМ-201}

\input{../../commons/doc/owen-trm201/prepare.tex}

\subsection{Подготовка МВУ-110}

\input{owen-mvu-110/prepare.tex}

\subsection{Подготовка АС-4}

\input{../../commons/doc/owen-as4/prepare.tex}

\subsection{Подготовка мультиметров}

\input{v7-78/prepare.tex}

\section{Подготовка программной части}

Запустите программу Установки.

Убедитесь в работоспособности Программы и всех аппаратных устройств. Для этого убедитесь, что Программа определяет и выводит на экран ПЭВМ температуру и сопротивления Образца. Откройте вкладку \CTL{Измерение} (она открыта сразу после запуска Программы). В текстовых полях (\CTL{Ток}, \CTL{Напряжение} и т.~д.), а также на графиках должны выводиться обработанные показания приборов. На графике производной температуры по времени $dT/dt$ показания могут выводиться с небольшой задержкой.

После того, как показания приборов начали отображаться на вкладке, убедитесь, что они лежат в ожидаемом диапазоне значений, что говорит о правильности подключения всех устройств и работы Установки. Если некоторые показания явно некорректные, проверьте качество соединений, положение кнопок <<Фронт/Тыльн>> мультиметров и пр.

\subsection{Параметры Образца}

Откройте закладку \CTL{Образец}. Данная вкладка содержит параметры измеряемого образца.

\subsubsection{Геометрические параметры}
\label{sec_geom_params}

\input{../../commons/doc/dut/geometry.tex}

\subsubsection{Файлы}

\input{../../commons/doc/dut/files.tex}

\subsection{Параметры измерения}

Откройте вкладку <<Параметры измерения>>. Содержимое данной вкладки определяет условия проведения измерений.

\subsubsection{Метод регистрации}
\label{sec_reg_method}

В данном разделе выбирается способ и частота регистрации измерений (см. описание принципа работы на стр.~\pageref{sec_registration_types}).

Если требуется регистрация с фиксированным временным интервалом, то выберите флаг \CTL{Временная зависимость}, после чего в поле \CTL{Временной шаг} введите значение интервала.

Если требуется регистрация с фиксированным температурным интервалом, то выберите флаг \CTL{Температурная зависимость}, после чего в поле \CTL{Температурный шаг} введите значение интервала.

Если требуется нерегулярная регистрация, то выберите флаг \CTL{Вручную}.

\subsubsection{Переполюсовка}
\label{sec_switch}

В данном разделе указываются параметры переполюсовки.

Для включения переполюсовки подключения источника тока, отметьте флаг \CTL{Переполюсовка тока}.

В поле \CTL{Пауза после переполюсовки} можно указать паузу между окончанием коммутаций и последующими измерениями.

В поле \CTL{Кол-во точек перед переполюсовкой} указывается количество измерений, которое производится при каждой полярности.

\subsubsection{Метод измерения сопротивления}

\input{ui/r-measures.tex}

\chapter{Измерения}

После подготовки к работе аппаратной и программной частей Установки можно приступить к измерениям.

\section{Проведение измерений}

Выберите вкладку \CTL{Измерение}. Ещё раз убедитесь в том, что все приборы работают, величины температуры и сопротивления Образца измеряются и находятся в ожидаемом диапазоне значений.

После этого нажмите кнопку \CTL{Начать запись}. Установка начнёт регистрацию температуры и сопротивления.

Оператор управляет температурой образца, например увеличением напряжения на обмотке электропечи. Скорость изменения температуры определяется требованиями эксперимента.

Если выбран режим ручной регистрации (стр.~\pageref{sec_reg_type_manual}), то оператор должен самостоятльно нажимать кнопку \CTL{Снять точку}\label{sec_manual} всякий раз, когда требуется зафиксировать измерение.

Кнопка \CTL{Снять точку} доступна и в других режимах, при регистрации временной и температурной зависимостей. То есть даже при автоматической регистрации оператор может вручную зарегистрировать нужное измерение. Например, если выбранный временной интервал довольно велик, а оператор наблюдает <<интересное поведение>> Образца, то он может вручную зафиксировать текущее измерение, даже если временной интервал ещё не истёк.

При необходимости Оператор может заблокировать запись в файл результатов без прекращения измерений. Для этого Оператор должен нажать кнопку \CTL{Приостановить запись}, после чего кнопка останется в <<нажатом>> состоянии. В режиме приостановки записи измерения производятся и отображаются на экране, но не сохраняются в файле результатов. Для возобновления записи оператор должен нажать кнопку повторно.

По окончании измерений нажмите кнопку \CTL{Остановить запись}, после чего в течении нескольких секунд программа зафиксирует все результаты в файлах. Файлы далее доступны для анализа.

Далее можно произвести новую серию измерений, или завершить работу Установки.

\section{Индикация измерений}

В процессе работы Установка производит снятие показаний приборов, обработку и отображение результатов на экране Программы. Частота, с которой производится опрос приборов, зависит от параметров измерения (см. раздел <<Метод регистрации>> на стр.~\pageref{sec_reg_method}), а также от скорости изменения температуры. Чем быстрее изменяется температура Образца, и чем меньше заданный температурный или временной интервал, чем чаще будут опрашиваться измерительные приборы.

Индикация измерений производится на вкладке \CTL{Измерение}.

\subsection{Диаграммы}

Четыре диаграммы показывают состояние основных регистрируемых величин:

\subsubsection{Зависимость $R(T)$}

На диаграмме изображается зависимость сопротивления Образца от температуры, измерения изображаются в виде зелёных точек, связанных друг с другом. Каждая залёная точка соответствует одному измерению, записанному в файл результатов. Если эксперимент достаточно продолжительный и точек становится слишком много, они автоматически прореживаются, разумеется только на графике.

Кроме того на этой же диаграмме отображается текущее значение сопротивление и температуры в виде небольшого числа сиреневых точек. Эти точки соответствуют промежуточным результатам, которые не подлежат регистрации в файле данных и нужны только для визуального контроля текущего состояния сборки.

\subsubsection{Зависимость R(t)}

На диаграмме изображается зависимость сопротивления Образца от времени, при этом по горизонтальной оси отложено количество измерений (а не время в секундах или иных непосредственных величинах).

Также на диаграмме изображается линейная аппроксимация зависимости $R(t)$ в виде фиолетовой линии. Эта линия даёт возможность оценить тренд изменения сопротивления.

\subsubsection{Зависимость T(t)}

На диаграмме изображается зависимость температуры Образца от времени, по горизонтальной оси отложено количество измерений. Также изображается линейная аппроксимация зависимости $T(t)$ в виде фиолетовой линии.

\subsubsection{Зависимость $\frac{dT}{dt}(t)$}

На диаграмме изображается зависимость скорости изменения температуры Образца от времени, по горизонтальной оси отложено количество измерений. Также изображается линейная аппроксимация зависимости $\frac{dT}{dt}(t)$ в виде фиолетовой линии.

Скорость изменения температуры вычисляется следующим образом. Делается несколько измерений температуры, по ним вычисляется линейная аппроксимация. Скорость изменения температуры определяется как угол наклона этой аппроксимации.

На данном графике значения могут появляться с небольшой задержкой, вызванной тем, что скорость изменения температуры вычисляется спустя некоторое минимальное число измерений.

\subsection{Текстовые поля}

Также индикация измерений производится в текстовых полях, вместе озаглавленных как \CTL{Результаты измерения}. Здесь выводятся следующие текущие значения:

\begin{itemize}
\item ток через Образец;
\item падение напряжения на потенциальных контактах Образца;
\item сопротивление между потенциальными контактами;
\item выделаемая тепловая мощность на Образце между потенциальными контактами (не на всём Образце!);
\item температура Образца и скорость её изменения.
\end{itemize}

Все величины сопровождаются инструментальной погрешностью.

\section{Файл результатов}

В файле результатов в начале идёт строка с комментарием (стр.~\pageref{sec_dut_comment}), далее идут следующие поля:

\begin{enumerate}
\item \CMD{Date/Time} --- местные дата и время, в которое было произведено измерение, в формате \mbox{\CMD{ГГГГ-ДД-ММ чч:мм:сс}}.
\item \CMD{T} --- температура Образца в К.
\item \CMD{+/-} --- погрешность определения температуры в К. Здесь и далее под погрешностью подразумевается абсолютная инструментальная погрешность.
\item \CMD{dT/dt} --- скорость изменения температуры в К/мин.
\item \CMD{I} --- ток через Образец в мА.
\item \CMD{+/-} --- погрешность определения тока в мА.
\item \CMD{U} --- падение напряжения на потенциальных контактах Образца в мВ.
\item \CMD{+/-} --- погрешность определения напряжения в мВ.
\item \CMD{R} --- сопротивление между потенциальными контактами Образца в Ом.
\item \CMD{+/-} --- погрешность определения сопротивления в Ом.
\item \CMD{Rho} --- удельное сопротивление между потенциальными контактами Образца в Ом${}\cdot{}$см. Если геометрические параметры Образца не были указаны (стр.~\pageref{sec_geom_params}), данное поле будет пустым.
\item \CMD{+/-} --- погрешность определения удельного сопротивления в Ом${}\cdot{}$см. Так же как и предыдущее, данное поле будет пустым при невозможности определения удельного сопротивления.
\item \CMD{Manual} --- если данная точка была снята вручную (стр.~\pageref{sec_manual}), в данном поле будет значение \CMD{true}, в противном случае поле будет пустым.
\end{enumerate}

\subsection{Файл с усреднёнными значениями}

Еcли Оператор включил переполюсовку (см. раздел <<Переполюсовка>> на стр.~\pageref{sec_switch}), то вместе с основным файлом результатов создаётся файл, в который записываются значения, полученные усреднением измерений в течении одного цикла переполюсовки.

Имя файла с усреднёнными значениями имеет такое же имя и расширение, как у основного файла, но перед расширением добавлен суфикс \CMD{.refined}.

Например, если основной файл результатов называется \CMD{data.txt}, то файл с усреднёнными значениями будет называться \CMD{data.refined.txt}.

\chapter{Завершение работы}

Для завершения работы Установки нажмите кнопку \CTL{Выход} в панели Программы. Программа произведёт сброс всех устройств в исходное состояние и закончит работу. Далее можно приступать к выключению аппаратной части.

\section{Отключение приборов}

Отключение приборов рекомендуется производить в указанной последовательности.

\subsection{Отключение мультиметров}

\input{v7-78/release.tex}

\subsection{Отключение источника питания}

\input{../../commons/doc/any-power-supply/release.tex}

После этого можно отсоединить приборы и сборку с Образцом.

\chapter{Настройка Программы}

При первом запуске Программы, а также при всяком изменении аппаратной части, требуется произвести настройку или перенастройку программной части, чтобы обеспечить связь с аппаратной частью и, возможно, её калибровку.

\section{Файл конфигурации}

\input{../../commons/doc/ini-file.tex}

\section{Настройка измерения сопротивления}

Откройте вкладку \CTL{Параметры измерения сопротивления} Программы. Здесь оператор вводит параметры (адреса и пр.) устройств, которые используются для определения сопротивления Образца.

\subsection{Блок реле}

В данном разделе --- параметры блока реле МВУ-110, содержащего переключатели S1--S3.

\input{owen-mvu-110/configure.tex}

\subsection{Вольтметр/омметр}
\label{sec_mm1_config}

В данном разделе --- параметры мультиметра MM1 (см. раздел <<Принципиальная схема>> на стр.~\pageref{sec_schematic_diagram}).

\input{v7-78/configure.tex}

\subsection{Амперметр}

В данном разделе --- параметры мультиметра MM2 (см. раздел <<Принципиальная схема>> на стр.~\pageref{sec_schematic_diagram}). Способ настройки~--- такой же, как для мультиметра MM1.

\IMPORTANT{Если мультиметр MM2 не используется в схеме Установки, то поле адреса должно быть пустым.}

\section{Настройка измерения температуры}

Откройте вкладку \CTL{Параметры измерения температуры} Программы. Здесь оператор вводит параметры (адреса и пр.) устройств, которые используются для определения температуры Образца.

\subsection{Способ подключения термопары}

В данном разделе оператор выбирает один из способов подключения термопары (см. раздел <<Определение температуры>> на стр.~\pageref{sec_t_measures}).

\subsection{Измеритель-регулятор ТРМ-201}

В данном разделе --- параметры ТРМ-201, используемого для определения температуры.

\input{../../commons/doc/owen-trm201/configure.tex}

\subsection{Термопара}

В данном разделе --- параметры термопары, используемой для определения температуры Образца.

\input{../../commons/doc/tc/configure.tex}

\section{Завершение настройки}

По окончании настройки Программа должна быть перезапущена, чтобы именения вошли в силу.

\chapter{Устранение неиправностей}

\section{Общие рекомендации}

Если при запуске Программы результаты измерений не отображаются, то рекомендуется выполнить следующие действия:

\begin{enumerate}
\item Убедитесь в правильности всех подключений.
\item Убедитесь, что выбранный в Программе метод измерения (стр.~\pageref{sec_r_measure_config}) соответствует схеме Установки и подключениям.
\item Убедитесь, что Программа установила связь со всеми устройствами. Для этого зайдите на вкладку \CTL{Параметры установки} и выполните опрос всех используемых устройств по очереди.
\end{enumerate}

В случае обнаружения неверных настроек (например, выбран неверный метод измерения или введён неправильный адрес устройства), выполните их коррекцию и перезапустите Программу.

Если все вышеуказанные действия не помогли, необходимо ознакомиться с содержимым файла протокола для детального выяснения неисправности.

\section{Файл протокола}

\input{../../commons/doc/log-file.tex}

\end{document}
